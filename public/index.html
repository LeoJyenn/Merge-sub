<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Merge-sub订阅合并系统</title>
    <link rel="icon" href="/icon.png">
    <link rel="apple-touch-icon" href="/icon.png">
    <link href="/index.css" rel="stylesheet">
    <script>
        (function() {
            if (window.location.href.indexOf('@') !== -1) {
                var cleanUrl = window.location.protocol + '//' + window.location.host + window.location.pathname;
                window.location.replace(cleanUrl);
            }
        })();
    </script>
</head>
<body>
    <div class="matrix-bg"></div>
    <div class="container">
        <div class="top-nav">
            <div class="system-status">
                <span>系统状态: 在线</span>
                <span class="status-sep">|</span>
                <span id="bjTime"></span>
            </div>
            <div class="nav-links">
                <button onclick="showSubscriptionInfo()" class="nav-btn">获取链接</button>
                <button onclick="configureBark()" class="nav-btn">Bark设置</button>
                <button onclick="backupData()" class="nav-btn">备份数据</button>
                <button onclick="restoreData()" class="nav-btn">恢复数据</button>
                <button onclick="resetSubLink()" class="nav-btn">重置订阅</button>
                <a href="/change-password.html" class="nav-btn">修改密码</a>
                <button id="logoutBtn" onclick="logout()" class="nav-btn">退出登录</button>
                <a href="https://github.com/LeoJyenn/Merge-sub" target="_blank" class="nav-btn">GitHub</a>
            </div>
        </div>

        <div class="page-layout">
            <div class="panel panel-add">
                <div class="panel-header">
                    <div class="panel-title">添加节点</div>
                    <div class="panel-subtitle">支持单个/多个节点或订阅链接，每行一个</div>
                </div>
                <div class="panel-body">
                    <div class="form-row">
                        <label class="input-label">节点内容</label>
                        <textarea id="addInput" class="input-textarea" placeholder="示例：vmess://、vless://、等，每行一条"></textarea>
                    </div>
                    <div class="remark-row">
                        <label class="remark-label">备注</label>
                        <input type="text" id="remarkInput" class="input-text" placeholder="可选：例如 家宽、IPLC、备用 等">
                        <button class="btn btn-primary" onclick="addItem()">添加</button>
                    </div>
                </div>
            </div>

            <div class="panel panel-list">
                <div class="panel-header">
                    <div class="panel-title">节点列表</div>
                    <div class="panel-right">
                        <span id="nodeCount" class="chip-count">加载中...</span>
                    </div>
                </div>

                <div class="panel-body panel-body-list">
                    <div id="data" class="node-list-wrapper">
                        正在初始化数据链路...
                    </div>
                </div>
            </div>
        </div>


        <div class="footer">
            管理员@LeoJyenn · 订阅合并系统
        </div>

        <input type="file" id="restoreInput" style="display:none" accept=".json">
    </div>
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>
    <script src="/script.js"></script>
</body>
</html>
